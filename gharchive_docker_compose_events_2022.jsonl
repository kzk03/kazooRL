{"id": "19542121384", "type": "IssueCommentEvent", "actor": {"id": 4894646, "login": "franklinchou", "display_login": "franklinchou", "gravatar_id": "", "url": "https://api.github.com/users/franklinchou", "avatar_url": "https://avatars.githubusercontent.com/u/4894646?"}, "repo": {"id": 15045751, "name": "docker/compose", "url": "https://api.github.com/repos/docker/compose"}, "payload": {"action": "created", "issue": {"url": "https://api.github.com/repos/docker/compose/issues/7423", "repository_url": "https://api.github.com/repos/docker/compose", "labels_url": "https://api.github.com/repos/docker/compose/issues/7423/labels{/name}", "comments_url": "https://api.github.com/repos/docker/compose/issues/7423/comments", "events_url": "https://api.github.com/repos/docker/compose/issues/7423/events", "html_url": "https://github.com/docker/compose/issues/7423", "id": 611587460, "node_id": "MDU6SXNzdWU2MTE1ODc0NjA=", "number": 7423, "title": "docker-compose does not set environment variables", "user": {"login": "Kytech", "id": 2079386, "node_id": "MDQ6VXNlcjIwNzkzODY=", "avatar_url": "https://avatars.githubusercontent.com/u/2079386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kytech", "html_url": "https://github.com/Kytech", "followers_url": "https://api.github.com/users/Kytech/followers", "following_url": "https://api.github.com/users/Kytech/following{/other_user}", "gists_url": "https://api.github.com/users/Kytech/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kytech/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kytech/subscriptions", "organizations_url": "https://api.github.com/users/Kytech/orgs", "repos_url": "https://api.github.com/users/Kytech/repos", "events_url": "https://api.github.com/users/Kytech/events{/privacy}", "received_events_url": "https://api.github.com/users/Kytech/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 69777235, "node_id": "MDU6TGFiZWw2OTc3NzIzNQ==", "url": "https://api.github.com/repos/docker/compose/labels/kind/bug", "name": "kind/bug", "color": "fc2929", "default": false, "description": null}, {"id": 3327019107, "node_id": "MDU6TGFiZWwzMzI3MDE5MTA3", "url": "https://api.github.com/repos/docker/compose/labels/Docker%20Compose%20V1", "name": "Docker Compose V1", "color": "FBCA04", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 19, "created_at": "2020-05-04T03:52:06Z", "updated_at": "2022-01-01T04:39:20Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "# Description of the issue\r\n\r\nWhen using `docker-compose up` or `docker-compose run -e ENVIRONMENT_VAR=value`, environment variables are not being applied either through the `-e` command line parameters or from the docker-compose.yml file.\r\n\r\nThe docker-compose.yml file I am using is as follows:\r\n```YML\r\nversion: '3'\r\nservices:\r\n    nginx-reverse-proxy:\r\n        image: nginx\r\n        volumes:\r\n         - C:/Users/<Username>/nginx-reverse-proxy/configdir:/etc/nginx/conf.d/\r\n        ports:\r\n         - \"80:80\"\r\n        environment:\r\n            NGINX_SERVER_NAME: \"test.mysite.org\"\r\n            NGINX_REMOTE_URL: \"http://remote.mysiteengine.somehost.com:13345\"\r\n```\r\n\r\n## Context information (for bug reports)\r\n\r\n**Output of `docker-compose version`**\r\n```\r\ndocker-compose version 1.25.5, build 8a1c60f6\r\n```\r\n\r\n**Output of `docker version`**\r\n```\r\nClient: Docker Engine - Community\r\n Version:           19.03.8\r\n API version:       1.40\r\n Go version:        go1.12.17\r\n Git commit:        afacb8b\r\n Built:             Wed Mar 11 01:23:10 2020\r\n OS/Arch:           windows/amd64\r\n Experimental:      false\r\n\r\nServer: Docker Engine - Community\r\n Engine:\r\n  Version:          19.03.8\r\n  API version:      1.40 (minimum version 1.12)\r\n  Go version:       go1.12.17\r\n  Git commit:       afacb8b\r\n  Built:            Wed Mar 11 01:29:16 2020\r\n  OS/Arch:          linux/amd64\r\n  Experimental:     false\r\n containerd:\r\n  Version:          v1.2.13\r\n  GitCommit:        7ad184331fa3e55e52b890ea95e65ba581ae3429\r\n runc:\r\n  Version:          1.0.0-rc10\r\n  GitCommit:        dc9208a3303feef5b3839f4323d9beb36df0a9dd\r\n docker-init:\r\n  Version:          0.18.0\r\n  GitCommit:        fec3683\r\n```\r\n\r\n**Output of `docker-compose config`**\r\n```\r\nWARNING: The NGINX_SERVER_NAME variable is not set. Defaulting to a blank string.\r\nWARNING: The NGINX_REMOTE_URL variable is not set. Defaulting to a blank string.\r\nservices:\r\n  nginx-reverse-proxy:\r\n    environment:\r\n      NGINX_SERVER_NAME: \"test.mysite.org\"\r\n      NGINX_REMOTE_URL: \"http://remote.mysiteengine.somehost.com:13345\"\r\n    image: nginx\r\n    ports:\r\n    - 80:80/tcp\r\n    volumes:\r\n    - C:\\Users\\<Username>\\nginx-reverse-proxy\\configdir:/etc/nginx/conf.d/:rw\r\nversion: '3.0'\r\n```\r\n\r\n\r\n## Steps to reproduce the issue\r\n\r\n1. Create a docker-compose.yml file that sets environment variables\r\n2. Run docker-compose up\r\n\r\n### Observed result\r\n\r\nEnvironment Variables are not applied\r\n\r\n### Expected result\r\n\r\nEnvironment variables should be applied to containers started by docker-compose\r\n\r\n### Stacktrace / full error message\r\n\r\n```\r\nWARNING: The NGINX_SERVER_NAME variable is not set. Defaulting to a blank string.\r\nWARNING: The NGINX_REMOTE_URL variable is not set. Defaulting to a blank string.\r\nCreating network \"nginx-reverse-proxy_default\" with the default driver\r\n```\r\n\r\n## Additional information\r\n\r\nOS Version: Windows 10 Pro v1909,\r\n`docker-compose` install method: Docker Desktop for Windows Installer, followed by manual upgrade of docker-compose (Issue occurred on docker-compose version 1.25.4 which was included with Docker Desktop and with manual upgrade to 1.25.5)\r\n", "reactions": {"url": "https://api.github.com/repos/docker/compose/issues/7423/reactions", "total_count": 9, "+1": 9, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/docker/compose/issues/7423/timeline", "performed_via_github_app": null}, "comment": {"url": "https://api.github.com/repos/docker/compose/issues/comments/1003504098", "html_url": "https://github.com/docker/compose/issues/7423#issuecomment-1003504098", "issue_url": "https://api.github.com/repos/docker/compose/issues/7423", "id": 1003504098, "node_id": "IC_kwDOAOWUd8470EHi", "user": {"login": "franklinchou", "id": 4894646, "node_id": "MDQ6VXNlcjQ4OTQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/4894646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/franklinchou", "html_url": "https://github.com/franklinchou", "followers_url": "https://api.github.com/users/franklinchou/followers", "following_url": "https://api.github.com/users/franklinchou/following{/other_user}", "gists_url": "https://api.github.com/users/franklinchou/gists{/gist_id}", "starred_url": "https://api.github.com/users/franklinchou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/franklinchou/subscriptions", "organizations_url": "https://api.github.com/users/franklinchou/orgs", "repos_url": "https://api.github.com/users/franklinchou/repos", "events_url": "https://api.github.com/users/franklinchou/events{/privacy}", "received_events_url": "https://api.github.com/users/franklinchou/received_events", "type": "User", "site_admin": false}, "created_at": "2022-01-01T04:39:19Z", "updated_at": "2022-01-01T04:39:19Z", "author_association": "NONE", "body": "Any update on this? Seems that docker-compose is still not picking up .env files?", "reactions": {"url": "https://api.github.com/repos/docker/compose/issues/comments/1003504098/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": null}}, "public": true, "created_at": "2022-01-01T04:39:20Z", "org": {"id": 5429470, "login": "docker", "gravatar_id": "", "url": "https://api.github.com/orgs/docker", "avatar_url": "https://avatars.githubusercontent.com/u/5429470?"}}
{"id": "19542501625", "type": "WatchEvent", "actor": {"id": 36514185, "login": "vinaysudani", "display_login": "vinaysudani", "gravatar_id": "", "url": "https://api.github.com/users/vinaysudani", "avatar_url": "https://avatars.githubusercontent.com/u/36514185?"}, "repo": {"id": 15045751, "name": "docker/compose", "url": "https://api.github.com/repos/docker/compose"}, "payload": {"action": "started"}, "public": true, "created_at": "2022-01-01T06:45:28Z", "org": {"id": 5429470, "login": "docker", "gravatar_id": "", "url": "https://api.github.com/orgs/docker", "avatar_url": "https://avatars.githubusercontent.com/u/5429470?"}}
{"id": "19542547537", "type": "IssueCommentEvent", "actor": {"id": 73785723, "login": "nodejsdeveloperskh", "display_login": "nodejsdeveloperskh", "gravatar_id": "", "url": "https://api.github.com/users/nodejsdeveloperskh", "avatar_url": "https://avatars.githubusercontent.com/u/73785723?"}, "repo": {"id": 15045751, "name": "docker/compose", "url": "https://api.github.com/repos/docker/compose"}, "payload": {"action": "created", "issue": {"url": "https://api.github.com/repos/docker/compose/issues/8523", "repository_url": "https://api.github.com/repos/docker/compose", "labels_url": "https://api.github.com/repos/docker/compose/issues/8523/labels{/name}", "comments_url": "https://api.github.com/repos/docker/compose/issues/8523/comments", "events_url": "https://api.github.com/repos/docker/compose/issues/8523/events", "html_url": "https://github.com/docker/compose/issues/8523", "id": 986441530, "node_id": "MDU6SXNzdWU5ODY0NDE1MzA=", "number": 8523, "title": "Docker-compose no longer gracefully stops", "user": {"login": "cchantep", "id": 166062, "node_id": "MDQ6VXNlcjE2NjA2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/166062?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cchantep", "html_url": "https://github.com/cchantep", "followers_url": "https://api.github.com/users/cchantep/followers", "following_url": "https://api.github.com/users/cchantep/following{/other_user}", "gists_url": "https://api.github.com/users/cchantep/gists{/gist_id}", "starred_url": "https://api.github.com/users/cchantep/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cchantep/subscriptions", "organizations_url": "https://api.github.com/users/cchantep/orgs", "repos_url": "https://api.github.com/users/cchantep/repos", "events_url": "https://api.github.com/users/cchantep/events{/privacy}", "received_events_url": "https://api.github.com/users/cchantep/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 3313137385, "node_id": "MDU6TGFiZWwzMzEzMTM3Mzg1", "url": "https://api.github.com/repos/docker/compose/labels/Docker%20Compose%20V2", "name": "Docker Compose V2", "color": "1D76DB", "default": false, "description": ""}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 22, "created_at": "2021-07-02T12:32:40Z", "updated_at": "2022-01-01T07:01:27Z", "closed_at": "2021-12-09T12:57:52Z", "author_association": "NONE", "active_lock_reason": null, "body": "### Expected behavior\r\n\r\nSuccessful graceful shutdown of `docker-compose`\r\n\r\n### Actual behavior\r\n\r\nAll containers are stopped, but compose is hanging on forever until we are forced to kill it.\r\n\r\n```\r\nGracefully stopping... (press Ctrl+C again to force)\r\n[+] Running 7/7\r\n \u283f Container PRJ-dev_spark-worker_1          Stopped                                                          11.3s\r\n \u283f Container PRJ-dev_spark-master_1          Stopped                                                          12.2s\r\n \u283f Container PRJ-dev_kafka-schemaregistry_1  Stopped                                                          11.3s\r\n \u283f Container PRJ-dev_mongodb_1               Stopped                                                          12.3s\r\n \u283f Container PRJ-dev_object-storage_1        Stopped                                                           1.7s\r\n \u283f Container PRJ-dev_kafka_1                 Stopped                                                           4.3s\r\n \u283f Container PRJ-dev_zookeeper_1             Stopped                                                          11.4s\r\n```\r\n\r\n(hanging forever ...)\r\n\r\n```\r\n^CERRO[3631] got 3 SIGTERM/SIGINTs, forcing shutdown      \r\n[+] Running 0/0\r\n \u283f Container PRJ-dev_mongodb_1               Error while Killing                                               0.0s\r\n \u283f Container PRJ-dev_spark-worker_1          Error while Killing                                               0.0s\r\n \u283f Container PRJ-dev_object-storage_1        Error while Killi...                                              0.0s\r\n \u283f Container PRJ-dev_spark-master_1          Error while Killing                                               0.0s\r\n \u283f Container PRJ-dev_kafka-schemaregistry_1  Error while...                                                    0.0s\r\n \u283f Container PRJ-dev_kafka_1                 Error while Killing                                               0.0s\r\n \u283f Container PRJ-dev_zookeeper_1             Error while Killing  \r\n```\r\n\r\n### Information\r\n\r\n  - macOS Version: 10.15.7\r\n  - Intel core i7\r\n  - Docker Desktop version: 3.5.1 (3.5.1.7)\r\n  - Docker Compose version: 2.0.0-beta.4\r\n\r\n### Steps to reproduce the behavior\r\n\r\n- On a fresh Docker Desktop (after data purge), `docker-compose -f any-conf.yml up`\r\n- Once everything is up, `Ctrl+C` to gracefully stop", "reactions": {"url": "https://api.github.com/repos/docker/compose/issues/8523/reactions", "total_count": 8, "+1": 8, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/docker/compose/issues/8523/timeline", "performed_via_github_app": null}, "comment": {"url": "https://api.github.com/repos/docker/compose/issues/comments/1003516222", "html_url": "https://github.com/docker/compose/issues/8523#issuecomment-1003516222", "issue_url": "https://api.github.com/repos/docker/compose/issues/8523", "id": 1003516222, "node_id": "IC_kwDOAOWUd8470HE-", "user": {"login": "nodejsdeveloperskh", "id": 73785723, "node_id": "MDQ6VXNlcjczNzg1NzIz", "avatar_url": "https://avatars.githubusercontent.com/u/73785723?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nodejsdeveloperskh", "html_url": "https://github.com/nodejsdeveloperskh", "followers_url": "https://api.github.com/users/nodejsdeveloperskh/followers", "following_url": "https://api.github.com/users/nodejsdeveloperskh/following{/other_user}", "gists_url": "https://api.github.com/users/nodejsdeveloperskh/gists{/gist_id}", "starred_url": "https://api.github.com/users/nodejsdeveloperskh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nodejsdeveloperskh/subscriptions", "organizations_url": "https://api.github.com/users/nodejsdeveloperskh/orgs", "repos_url": "https://api.github.com/users/nodejsdeveloperskh/repos", "events_url": "https://api.github.com/users/nodejsdeveloperskh/events{/privacy}", "received_events_url": "https://api.github.com/users/nodejsdeveloperskh/received_events", "type": "User", "site_admin": false}, "created_at": "2022-01-01T07:01:26Z", "updated_at": "2022-01-01T07:01:26Z", "author_association": "NONE", "body": "I face the same problem in Manjaro. \r\ndocker-compose.yml\r\n```yaml\r\nversion: \"3.7\"\r\n\r\nservices:\r\n  api-dev:\r\n    image: ${COMPOSE_PROJECT_NAME}-dev:latest\r\n    container_name: \"${COMPOSE_PROJECT_NAME}-dev-${APP_NAME}\"\r\n    restart: always\r\n    volumes:\r\n      - type: bind\r\n        source: .\r\n        target: /app\r\n        volume:\r\n          nocopy: true\r\n    build:\r\n      context: .\r\n      dockerfile: ./dev.Dockerfile\r\n    ports:\r\n      - \"${APP_PORT}:${APP_PORT}\"\r\n      - \"${DEBUGGING_PORT}:${DEBUGGING_PORT}\"\r\n    environment:\r\n      NODE_ENV: development\r\n    env_file:\r\n      - ./.env\r\n```\r\n\r\nand Dockerfile\r\n```Dockerfile\r\n# Installation stage\r\nFROM node:16.13-alpine as copy_stage\r\n\r\nWORKDIR /app\r\n\r\nCOPY package.json package-lock.json ./\r\n\r\nRUN npm config set registry https://registry.npmjs.org/ && npm config set maxsockets 20\r\nRUN npm ci --loglevel verbose\r\n\r\n# Creating isolated image with the installed pacakges inside node_modules\r\nFROM node:16.13-buster\r\n\r\nRUN mkdir -p /app && chown -R 1000:1000 /app\r\n\r\nWORKDIR /app\r\n\r\nENV NODE_PATH=/usr/local/lib/node_modules/\r\n\r\nCOPY --chown=1000:1000 --from=copy_stage /app .\r\n\r\nEXPOSE ${APP_PORT}\r\nEXPOSE ${DEBUGGING_PORT}\r\n\r\nUSER 1000:1000\r\n\r\nCMD [ \"npm\", \"run\", \"start:dev\" ]\r\n```\r\n\r\n`docker version` command output:\r\n```cmd\r\nClient:\r\n Version:           20.10.11\r\n API version:       1.41\r\n Go version:        go1.17.3\r\n Git commit:        dea9396e18\r\n Built:             Sat Nov 20 12:57:52 2021\r\n OS/Arch:           linux/amd64\r\n Context:           default\r\n Experimental:      true\r\n\r\nServer:\r\n Engine:\r\n  Version:          20.10.11\r\n  API version:      1.41 (minimum version 1.12)\r\n  Go version:       go1.17.3\r\n  Git commit:       847da184ad\r\n  Built:            Sat Nov 20 12:57:08 2021\r\n  OS/Arch:          linux/amd64\r\n  Experimental:     false\r\n containerd:\r\n  Version:          v1.5.8\r\n  GitCommit:        1e5ef943eb76627a6d3b6de8cd1ef6537f393a71.m\r\n runc:\r\n  Version:          1.0.3\r\n  GitCommit:        v1.0.3-0-gf46b6ba2\r\n docker-init:\r\n  Version:          0.19.0\r\n  GitCommit:        de40ad0\r\n```\r\n`uname -a` command output:\r\n```cmd\r\nLinux kasir 5.10.84-1-MANJARO #1 SMP PREEMPT Wed Dec 8 09:50:30 UTC 2021 x86_64 GNU/Linux\r\n```\r\nMy docker container up and run successfully but It cannot stop containers gracefully and I have to press `ctrl + c` twice.", "reactions": {"url": "https://api.github.com/repos/docker/compose/issues/comments/1003516222/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": null}}, "public": true, "created_at": "2022-01-01T07:01:27Z", "org": {"id": 5429470, "login": "docker", "gravatar_id": "", "url": "https://api.github.com/orgs/docker", "avatar_url": "https://avatars.githubusercontent.com/u/5429470?"}}
